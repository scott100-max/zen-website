<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Breathing Exercises — Salus</title>
  <meta name="description" content="Interactive breathing exercises tailored to your needs. Relax, focus, energise, or unwind with guided breathwork from Salus.">
  <link rel="canonical" href="https://salus-mind.com/breathe.html">
  <meta property="og:title" content="Breathing Exercises — Salus">
  <meta property="og:description" content="Interactive breathing exercises tailored to your needs. Relax, focus, energise, or unwind with guided breathwork from Salus.">
  <meta property="og:url" content="https://salus-mind.com/breathe.html">
  <meta property="og:type" content="website">
  <meta property="og:image" content="https://salus-mind.com/images/meditation-woman-outdoor.jpg">
  <meta name="twitter:card" content="summary_large_image">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Cormorant+Garamond:wght@600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="css/style.css?v=1770564391">
  <style>
    .intent-screen { text-align: center; padding: 60px 0; }
    .intent-grid {
      display: grid; grid-template-columns: repeat(3, 1fr); gap: 16px;
      max-width: 520px; margin: 32px auto 0;
    }
    .intent-btn {
      background: rgba(255,255,255,0.03); border: 1px solid rgba(255,255,255,0.06); border-radius: 16px;
      padding: 28px 16px; cursor: pointer; transition: all 0.35s ease; text-align: center;
      position: relative; overflow: hidden;
    }
    .intent-btn::before {
      content: ''; position: absolute; inset: 0; opacity: 0; transition: opacity 0.35s ease; border-radius: 16px;
    }
    .intent-btn:hover { transform: translateY(-3px); box-shadow: 0 12px 32px rgba(0,0,0,0.3); }
    .intent-btn:hover::before { opacity: 1; }
    .intent-btn[data-intent="relax"]::before { background: radial-gradient(ellipse at 50% 80%, rgba(46,125,50,0.15), transparent 70%); }
    .intent-btn[data-intent="focus"]::before { background: radial-gradient(ellipse at 50% 80%, rgba(21,101,192,0.15), transparent 70%); }
    .intent-btn[data-intent="sleep"]::before { background: radial-gradient(ellipse at 50% 80%, rgba(69,39,160,0.15), transparent 70%); }
    .intent-btn[data-intent="energise"]::before { background: radial-gradient(ellipse at 50% 80%, rgba(230,81,0,0.15), transparent 70%); }
    .intent-btn[data-intent="calm"]::before { background: radial-gradient(ellipse at 50% 80%, rgba(0,121,107,0.15), transparent 70%); }
    .intent-btn[data-intent="unwind"]::before { background: radial-gradient(ellipse at 50% 80%, rgba(173,20,87,0.15), transparent 70%); }
    .intent-btn:hover { border-color: rgba(255,255,255,0.12); }
    .intent-btn.selected { border-color: var(--accent); background: rgba(79,109,245,0.1); }
    .intent-icon { width: 48px; height: 48px; margin: 0 auto 14px; display: block; }
    .intent-label { font-weight: 500; font-size: 0.88rem; color: #f0eefc; letter-spacing: 0.02em; }
    .intent-sub { font-weight: 300; font-size: 0.7rem; color: rgba(240,238,252,0.35); margin-top: 4px; display: block; }

    .breathe-fullscreen {
      display: none; flex-direction: column; align-items: center; justify-content: center;
      min-height: 70vh; padding: 40px 20px; position: relative;
      transition: background 1s ease;
    }
    .breathe-fullscreen.active { display: flex; }

    .breathe-ring-wrap {
      position: relative; width: 280px; height: 280px;
      display: flex; align-items: center; justify-content: center;
      margin-bottom: 32px;
    }

    /* Progress ring */
    .progress-ring { position: absolute; top: 0; left: 0; transform: rotate(-90deg); }
    .progress-ring circle {
      fill: none; stroke-width: 4;
    }
    .progress-ring .ring-bg { stroke: rgba(255,255,255,0.1); }
    .progress-ring .ring-fg { stroke: var(--accent); stroke-linecap: round; transition: stroke-dashoffset 0.3s linear; }

    .breathe-orb {
      width: 140px; height: 140px; border-radius: 50%;
      display: flex; align-items: center; justify-content: center; flex-direction: column;
      transition: transform 0.1s linear;
      box-shadow: 0 0 60px rgba(0,0,0,0.08);
    }
    .breathe-orb.inhale  { animation: orbExpand 4s ease-in-out forwards; }
    .breathe-orb.hold    { transform: scale(1.8); }
    .breathe-orb.exhale-478  { animation: orbContract 8s ease-in-out forwards; }
    .breathe-orb.exhale-box  { animation: orbContract 4s ease-in-out forwards; }
    .breathe-orb.exhale-calm { animation: orbContract 6s ease-in-out forwards; }
    .breathe-orb.stopped { transform: scale(1); transition: transform 0.4s ease; }

    @keyframes orbExpand  { from { transform: scale(1); } to { transform: scale(1.8); } }
    @keyframes orbContract { from { transform: scale(1.8); } to { transform: scale(1); } }

    .breathe-instruction {
      font-size: 1.3rem; font-weight: 600; color: #f0eefc; margin-bottom: 4px;
      min-height: 1.6em;
    }
    .breathe-timer {
      font-size: 2.4rem; font-weight: 700; color: #f0eefc;
      min-height: 1.2em;
    }

    .breathe-meta {
      text-align: center; margin-top: 8px; color: var(--mid-gray); font-size: 0.85rem;
    }

    .breathe-actions { display: flex; gap: 16px; margin-top: 24px; align-items: center; }
    .breathe-actions .btn { min-width: 120px; }

    .technique-name {
      font-size: 0.85rem; color: var(--accent); font-weight: 600;
      letter-spacing: 1px; text-transform: uppercase; margin-bottom: 8px;
    }

    .back-link {
      display: inline-flex; align-items: center; gap: 6px;
      color: var(--mid-gray); font-size: 0.85rem; text-decoration: none;
      margin-bottom: 24px; cursor: pointer; border: none; background: none;
      font-family: inherit;
    }
    .back-link:hover { color: #f0eefc; }

    /* Colour themes per intent */
    .theme-relax .breathe-orb   { background: radial-gradient(circle at 40% 35%, #e8f5e9, #81c784 40%, #4caf50 70%, #2e7d32); box-shadow: 0 0 50px rgba(76,175,80,0.3); }
    .theme-focus .breathe-orb   { background: radial-gradient(circle at 40% 35%, #e3f2fd, #64b5f6 40%, #1e88e5 70%, #1565c0); box-shadow: 0 0 50px rgba(30,136,229,0.3); }
    .theme-sleep .breathe-orb   { background: radial-gradient(circle at 40% 35%, #ede7f6, #b39ddb 40%, #7e57c2 70%, #4527a0); box-shadow: 0 0 50px rgba(126,87,194,0.3); }
    .theme-energise .breathe-orb { background: radial-gradient(circle at 40% 35%, #fff8e1, #ffd54f 40%, #ffb300 70%, #e65100); box-shadow: 0 0 50px rgba(255,179,0,0.3); }
    .theme-calm .breathe-orb    { background: radial-gradient(circle at 40% 35%, #e0f7fa, #80cbc4 40%, #4ecdc4 70%, #00796b); box-shadow: 0 0 50px rgba(78,205,196,0.3); }
    .theme-unwind .breathe-orb  { background: radial-gradient(circle at 40% 35%, #fce4ec, #f48fb1 40%, #e91e63 70%, #ad1457); box-shadow: 0 0 50px rgba(233,30,99,0.3); }

    .breathe-instruction { color: #f0eefc; } .breathe-timer { color: #f0eefc; }

    @media (max-width: 520px) {
      .intent-grid { grid-template-columns: repeat(2, 1fr); }
      .breathe-ring-wrap { width: 220px; height: 220px; }
      .breathe-orb { width: 100px; height: 100px; }
      .progress-ring { width: 100%; height: 100%; }
      .breathe-instruction { font-size: 1rem; }
      .breathe-timer { font-size: 1.8rem; }
      .breathe-actions { flex-direction: column; width: 100%; }
      .breathe-actions .btn { width: 100%; }
    }
  </style>
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
  <script src="js/supabase-config.js"></script>
  <script src="js/auth.js?v=1770564391"></script>
</head>
<body>


      <nav class="nav-wrap" id="navWrap">
  <div class="nav-inner">
    <div class="nav-row-1">
      <a href="index.html" class="nav-brand">SALUS</a>
      <ul class="nav-primary">
        <li><a href="index.html">Home</a></li>
        <li><a href="sessions.html">Meditations</a></li>
        <li><a href="mindfulness.html">Mindfulness</a></li>
        <li><a href="cbt.html">CBT Exercises</a></li>
        <li><a href="asmr.html">ASMR</a></li>
        <li><a href="sleep-stories.html">Sleep Stories</a></li>
        <li><a href="education.html">Learn</a></li>
        <li><a href="about.html">About</a></li>
      </ul>
      <div class="nav-ctas">
        <a href="apps.html" class="nav-cta nav-cta--subscribe">Subscribe</a>
        <a href="login.html" class="nav-cta nav-cta--login nav-auth-btn">Log In</a>
      </div>
      <button class="nav-burger" id="burgerBtn" aria-label="Menu">
        <span></span><span></span><span></span>
      </button>
    </div>
    <div class="nav-row-2">
      <a href="tools.html">Tools</a>
      <a href="reading.html">Reading</a>
      <a href="applied-psychology.html">Applied Psychology</a>
      <a href="cbt.html">CBT</a>
      <a href="newsletter.html">Newsletter</a>
      <a href="contact.html">Contact</a>
      <a href="lend-your-voice.html">Lend Your Voice</a>
    </div>
  </div>
</nav>
<div class="nav-drawer" id="navDrawer">
  <div class="nav-drawer__section-label">Main</div>
  <a href="index.html" class="nav-drawer__link"><span class="nav-drawer__link-dot"></span>Home</a>
  <a href="sessions.html" class="nav-drawer__link"><span class="nav-drawer__link-dot"></span>Meditations</a>
  <a href="mindfulness.html" class="nav-drawer__link"><span class="nav-drawer__link-dot"></span>Mindfulness</a>
  <a href="cbt.html" class="nav-drawer__link"><span class="nav-drawer__link-dot"></span>CBT Exercises</a>
  <a href="asmr.html" class="nav-drawer__link"><span class="nav-drawer__link-dot"></span>ASMR</a>
  <a href="sleep-stories.html" class="nav-drawer__link"><span class="nav-drawer__link-dot"></span>Sleep Stories</a>
  <a href="education.html" class="nav-drawer__link"><span class="nav-drawer__link-dot"></span>Learn</a>
  <a href="about.html" class="nav-drawer__link"><span class="nav-drawer__link-dot"></span>About</a>
  <div class="nav-drawer__section-label">More</div>
  <a href="tools.html" class="nav-drawer__link"><span class="nav-drawer__link-dot" style="background:rgba(240,238,252,0.4)"></span>Tools</a>
  <a href="reading.html" class="nav-drawer__link"><span class="nav-drawer__link-dot" style="background:rgba(240,238,252,0.4)"></span>Reading</a>
  <a href="applied-psychology.html" class="nav-drawer__link"><span class="nav-drawer__link-dot" style="background:rgba(240,238,252,0.4)"></span>Applied Psychology</a>
  <a href="cbt.html" class="nav-drawer__link"><span class="nav-drawer__link-dot" style="background:rgba(240,238,252,0.4)"></span>CBT Exercises</a>
  <a href="newsletter.html" class="nav-drawer__link"><span class="nav-drawer__link-dot" style="background:rgba(240,238,252,0.4)"></span>Newsletter</a>
  <a href="contact.html" class="nav-drawer__link"><span class="nav-drawer__link-dot" style="background:rgba(240,238,252,0.4)"></span>Contact</a>
  <a href="lend-your-voice.html" class="nav-drawer__link"><span class="nav-drawer__link-dot" style="background:rgba(240,238,252,0.4)"></span>Lend Your Voice</a>
  <div class="nav-drawer__ctas">
    <a href="apps.html" class="nav-cta nav-cta--subscribe">Subscribe</a>
    <a href="login.html" class="nav-cta nav-cta--login nav-auth-btn">Log In</a>
  </div>
</div>

  <section style="padding:120px 0 40px;text-align:center;position:relative;overflow:hidden;">
    <div style="position:absolute;inset:0;background:radial-gradient(ellipse 50% 50% at 50% 40%,rgba(78,205,196,0.04) 0%,transparent 60%);pointer-events:none;"></div>
    <div class="container" style="position:relative;z-index:2;">
      <div style="display:inline-flex;align-items:center;gap:10px;font-weight:300;font-size:.72rem;letter-spacing:.28em;text-transform:uppercase;color:rgba(78,205,196,0.6);margin-bottom:20px;">
        <span style="width:24px;height:1px;background:linear-gradient(90deg,transparent,rgba(78,205,196,0.35),transparent);display:inline-block;"></span>
        Interactive Tool
        <span style="width:24px;height:1px;background:linear-gradient(90deg,transparent,rgba(78,205,196,0.35),transparent);display:inline-block;"></span>
      </div>
      <h1 style="font-family:'Cormorant Garamond',serif;font-weight:300;font-size:clamp(2.4rem,6vw,3.8rem);line-height:1.1;margin-bottom:16px;"><span style="background:linear-gradient(135deg,#f2f0fa 15%,#4ecdc4 60%,#34d399 100%);-webkit-background-clip:text;background-clip:text;-webkit-text-fill-color:transparent;">Breathing Exercises</span></h1>
      <p style="font-weight:200;font-size:clamp(.9rem,1.6vw,1.05rem);line-height:1.75;color:rgba(242,240,250,0.45);max-width:460px;margin:0 auto;">Choose how you'd like to feel, and we'll guide you through the right technique.</p>
    </div>
  </section>

  <!-- Intent Selection -->
  <section id="intentScreen" class="intent-screen" style="background:transparent;">
    <div class="container">
      <div class="intent-grid">
        <button class="intent-btn" data-intent="relax" onclick="selectIntent('relax')">
          <svg class="intent-icon" viewBox="0 0 48 48" fill="none"><circle cx="24" cy="24" r="18" stroke="#4caf50" stroke-width="1.5" opacity="0.3"/><path d="M16 28c2-4 5-6 8-6s6 2 8 6" stroke="#4caf50" stroke-width="1.5" stroke-linecap="round"/><path d="M24 14v8M20 18l4 4 4-4" stroke="#66bb6a" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/></svg>
          <span class="intent-label">Relax</span>
          <span class="intent-sub">4-7-8 extended exhale</span>
        </button>
        <button class="intent-btn" data-intent="focus" onclick="selectIntent('focus')">
          <svg class="intent-icon" viewBox="0 0 48 48" fill="none"><circle cx="24" cy="24" r="18" stroke="#42a5f5" stroke-width="1.5" opacity="0.3"/><circle cx="24" cy="24" r="6" stroke="#42a5f5" stroke-width="1.5"/><circle cx="24" cy="24" r="2" fill="#64b5f6"/><line x1="24" y1="6" x2="24" y2="12" stroke="#42a5f5" stroke-width="1" opacity="0.5"/><line x1="24" y1="36" x2="24" y2="42" stroke="#42a5f5" stroke-width="1" opacity="0.5"/><line x1="6" y1="24" x2="12" y2="24" stroke="#42a5f5" stroke-width="1" opacity="0.5"/><line x1="36" y1="24" x2="42" y2="24" stroke="#42a5f5" stroke-width="1" opacity="0.5"/></svg>
          <span class="intent-label">Focus</span>
          <span class="intent-sub">Box breathing 4-4-4-4</span>
        </button>
        <button class="intent-btn" data-intent="sleep" onclick="selectIntent('sleep')">
          <svg class="intent-icon" viewBox="0 0 48 48" fill="none"><circle cx="24" cy="24" r="18" stroke="#9575cd" stroke-width="1.5" opacity="0.3"/><path d="M20 16c-1 0-2 1-2 3s1 3 2 3c4 0 8 3 8 7" stroke="#9575cd" stroke-width="1.5" stroke-linecap="round"/><circle cx="30" cy="14" r="1.5" fill="#b39ddb" opacity="0.6"/><circle cx="34" cy="18" r="1" fill="#b39ddb" opacity="0.4"/><circle cx="36" cy="13" r="0.8" fill="#b39ddb" opacity="0.3"/></svg>
          <span class="intent-label">Sleep</span>
          <span class="intent-sub">4-7-8 deep rest</span>
        </button>
        <button class="intent-btn" data-intent="energise" onclick="selectIntent('energise')">
          <svg class="intent-icon" viewBox="0 0 48 48" fill="none"><circle cx="24" cy="24" r="18" stroke="#ffb300" stroke-width="1.5" opacity="0.3"/><path d="M26 12l-4 12h6l-4 12" stroke="#ffb300" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>
          <span class="intent-label">Energise</span>
          <span class="intent-sub">Bellows breath</span>
        </button>
        <button class="intent-btn" data-intent="calm" onclick="selectIntent('calm')">
          <svg class="intent-icon" viewBox="0 0 48 48" fill="none"><circle cx="24" cy="24" r="18" stroke="#4ecdc4" stroke-width="1.5" opacity="0.3"/><path d="M12 28c4-3 8-5 12-5s8 2 12 5" stroke="#4ecdc4" stroke-width="1.5" stroke-linecap="round"/><path d="M14 32c3-2 6-3 10-3s7 1 10 3" stroke="#4ecdc4" stroke-width="1" stroke-linecap="round" opacity="0.4"/></svg>
          <span class="intent-label">Calm</span>
          <span class="intent-sub">4-4-6 calming breath</span>
        </button>
        <button class="intent-btn" data-intent="unwind" onclick="selectIntent('unwind')">
          <svg class="intent-icon" viewBox="0 0 48 48" fill="none"><circle cx="24" cy="24" r="18" stroke="#f06292" stroke-width="1.5" opacity="0.3"/><path d="M18 20c0 0 2 8 6 8s6-8 6-8" stroke="#f06292" stroke-width="1.5" stroke-linecap="round"/><path d="M20 30c1 2 2.5 3 4 3s3-1 4-3" stroke="#f06292" stroke-width="1" stroke-linecap="round" opacity="0.5"/></svg>
          <span class="intent-label">Unwind</span>
          <span class="intent-sub">2-4 slow release</span>
        </button>
      </div>
    </div>
  </section>

  <!-- Breathing Exercise -->
  <section id="breatheScreen" class="breathe-fullscreen">
    <div class="container" style="display:flex;flex-direction:column;align-items:center;">

      <button class="back-link" onclick="goBack()">&larr; Choose another</button>

      <div class="technique-name" id="techniqueName"></div>

      <div class="breathe-ring-wrap">
        <svg class="progress-ring" width="280" height="280" viewBox="0 0 280 280">
          <circle class="ring-bg" cx="140" cy="140" r="132"/>
          <circle class="ring-fg" id="ringFg" cx="140" cy="140" r="132"/>
        </svg>
        <div class="breathe-orb" id="breatheOrb">
          <span class="breathe-instruction" id="breathePhase">Ready</span>
          <span class="breathe-timer" id="breatheTimer"></span>
        </div>
      </div>

      <div class="breathe-meta" id="breatheMeta"></div>

      <div class="breathe-actions">
        <button class="btn btn-primary" id="breatheToggle">Start</button>
      </div>
      <div style="margin-top:12px;font-size:0.9rem;color:var(--mid-gray);font-weight:500;" id="breatheCycles">Cycles: 0</div>
    </div>
  </section>

  <!-- Info -->
  <section style="background:transparent;padding:60px 0;">
    <div class="container" style="max-width:700px;text-align:center;">
      <h2 class="fade-in" style="margin-bottom:16px;">Why Breathwork?</h2>
      <p class="fade-in" style="color:var(--mid-gray);line-height:1.8;font-size:0.95rem;margin-bottom:16px;">
        Controlled breathing activates the parasympathetic nervous system — your body's natural "rest and digest" response. In just a few minutes, you can lower your heart rate, reduce cortisol levels, and shift from fight-or-flight to calm.
      </p>
      <p class="fade-in" style="color:var(--mid-gray);line-height:1.8;font-size:0.95rem;">
        Research by Dr Andrew Huberman (Stanford) shows that specific breathing patterns — particularly the physiological sigh — are among the fastest ways to reduce real-time stress.
      </p>
    </div>
  </section>

  <section class="cta-banner">
    <div class="container">
      <h2 class="fade-in">Join the Salus family</h2>
      <p class="fade-in">Guided breathwork, sleep stories, soundscapes, and more — built by a family, not a corporation.</p>
      <a href="apps.html" class="btn fade-in">Subscribe</a>
    </div>
  </section>

  <footer class="hb-footer">
  <div class="hb-footer__inner">
    <div class="hb-footer__brand">
      <span class="hb-footer__logo">Salus</span>
      <p class="hb-footer__tagline">A quieter kind of self-care. Guided meditations, sleep stories, ASMR, and mindfulness tools &mdash; built by a family.</p>
    </div>
    <div>
      <h4 class="hb-footer__col-title">Practice</h4>
      <ul class="hb-footer__links">
        <li><a href="sessions.html">Meditation Exercises</a></li>
        <li><a href="mindfulness.html">Mindfulness</a></li>
        <li><a href="asmr.html">ASMR &amp; Sounds</a></li>
        <li><a href="sleep-stories.html">Sleep Stories</a></li>
        <li><a href="cbt.html">CBT Exercises</a></li>
        <li><a href="tools.html">Tools</a></li>
      </ul>
    </div>
    <div>
      <h4 class="hb-footer__col-title">Discover</h4>
      <ul class="hb-footer__links">
        <li><a href="education.html">Learn</a></li>
        <li><a href="reading.html">Reading</a></li>
        <li><a href="applied-psychology.html">Applied Psychology</a></li>
        <li><a href="newsletter.html">Newsletter</a></li>
      </ul>
    </div>
    <div>
      <h4 class="hb-footer__col-title">Salus</h4>
      <ul class="hb-footer__links">
        <li><a href="about.html">About Us</a></li>
        <li><a href="apps.html">Go Premium</a></li>
        <li><a href="contact.html">Contact</a></li>
      </ul>
    </div>
  </div>
  <p class="footer-disclaimer">Salus does not provide medical advice. Content is for general wellbeing and is not a substitute for professional medical advice, diagnosis, or treatment. Always consult a qualified health provider with any health concerns.</p>
  <div class="hb-footer__bottom">
    <span class="hb-footer__copy">&copy; 2026 Salus Mind. All rights reserved.</span>
    <a href="#" class="hb-footer__back-top" onclick="window.scrollTo({top:0,behavior:'smooth'});return false;">
      Back to top
      <svg viewBox="0 0 24 24"><polyline points="18 15 12 9 6 15"/></svg>
    </a>
  </div>
</footer>

  <script src="js/main.js?v=1770564391"></script>
  <script src="js/tracker.js"></script>
  <script>
    // Techniques mapped to intents - each has distinct timing patterns
    var techniques = {
      relax:    { name: 'Resonant Breathing', phases: [{n:'Breathe in',d:5,c:'inhale'},{n:'Breathe out',d:5,c:'exhale-box'}], desc: '5-5 rhythm. The "coherent breathing" pattern shown to optimise heart rate variability.' },
      focus:    { name: 'Box Breathing', phases: [{n:'Breathe in',d:4,c:'inhale'},{n:'Hold',d:4,c:'hold'},{n:'Breathe out',d:4,c:'exhale-box'},{n:'Hold',d:4,c:'hold'}], desc: '4-4-4-4 pattern. Used by Navy SEALs to sharpen concentration under pressure.' },
      sleep:    { name: '4-7-8 Sleep', phases: [{n:'Breathe in',d:4,c:'inhale'},{n:'Hold',d:7,c:'hold'},{n:'Breathe out',d:8,c:'exhale-478'}], desc: '4-7-8 pattern. Dr Andrew Weil\'s technique for falling asleep naturally.' },
      energise: { name: 'Bellows Breath', phases: [{n:'Breathe in',d:2,c:'inhale'},{n:'Breathe out',d:2,c:'exhale-box'}], desc: '2-2 rapid cycles. Quick breathing to energise and wake up your system.' },
      calm:     { name: 'Calming Breath', phases: [{n:'Breathe in',d:4,c:'inhale'},{n:'Hold',d:4,c:'hold'},{n:'Breathe out',d:6,c:'exhale-calm'}], desc: '4-4-6 pattern. Extended exhale activates your calming response.' },
      unwind:   { name: 'Extended Exhale', phases: [{n:'Breathe in',d:4,c:'inhale'},{n:'Breathe out',d:8,c:'exhale-478'}], desc: '4-8 pattern. Double-length exhale to deeply relax the nervous system.' }
    };

    var currentIntent = null;
    var running = false;
    var cycles = 0;
    var phaseIndex = 0;
    var totalSeconds = 0;
    var cycleElapsed = 0;
    var phaseElapsed = 0;
    var currentPhaseDuration = 0;
    var mainTimer = null;

    var orb = document.getElementById('breatheOrb');
    var phaseEl = document.getElementById('breathePhase');
    var timerEl = document.getElementById('breatheTimer');
    var cyclesEl = document.getElementById('breatheCycles');
    var toggleBtn = document.getElementById('breatheToggle');
    var ringFg = document.getElementById('ringFg');
    var circumference = 2 * Math.PI * 132;

    ringFg.style.strokeDasharray = circumference;
    ringFg.style.strokeDashoffset = circumference;

    // Audio chimes
    var audioCtx = null;
    function playChime(freq, dur) {
      if (!audioCtx) audioCtx = new (window.AudioContext || window.webkitAudioContext)();
      var osc = audioCtx.createOscillator();
      var gain = audioCtx.createGain();
      osc.connect(gain); gain.connect(audioCtx.destination);
      osc.type = 'sine'; osc.frequency.value = freq;
      gain.gain.setValueAtTime(0.2, audioCtx.currentTime);
      gain.gain.exponentialRampToValueAtTime(0.001, audioCtx.currentTime + dur);
      osc.start(); osc.stop(audioCtx.currentTime + dur);
    }

    function selectIntent(intent) {
      currentIntent = intent;
      document.querySelectorAll('.intent-btn').forEach(function(b) { b.classList.remove('selected'); });
      document.querySelector('[data-intent="'+intent+'"]').classList.add('selected');

      // Show breathing screen
      document.getElementById('intentScreen').style.display = 'none';
      var screen = document.getElementById('breatheScreen');
      screen.className = 'breathe-fullscreen active theme-' + intent;
      document.getElementById('techniqueName').textContent = techniques[intent].name;
      document.getElementById('breatheMeta').textContent = techniques[intent].desc;

      // Calculate cycle duration for progress ring
      var t = techniques[intent];
      totalSeconds = 0;
      t.phases.forEach(function(p) { totalSeconds += p.d; });

      reset();
    }

    function goBack() {
      stop();
      document.getElementById('breatheScreen').classList.remove('active');
      document.getElementById('breatheScreen').style.display = 'none';
      document.getElementById('intentScreen').style.display = '';
    }

    function clearClasses() {
      orb.classList.remove('inhale','hold','exhale-478','exhale-box','exhale-calm','stopped');
      void orb.offsetWidth;
    }

    // Single unified tick function for both countdown and ring
    function tick() {
      if (!running) return;

      phaseElapsed++;
      cycleElapsed++;

      // Update countdown display
      var remaining = currentPhaseDuration - phaseElapsed;
      timerEl.textContent = remaining > 0 ? remaining : 1;

      // Update ring progress (synced with countdown)
      var cyclePos = cycleElapsed % totalSeconds;
      var pct = cyclePos / totalSeconds;
      ringFg.style.strokeDashoffset = circumference * (1 - pct);

      // Move to next phase when countdown reaches 0
      if (phaseElapsed >= currentPhaseDuration) {
        nextPhase();
      }
    }

    function nextPhase() {
      if (!running) return;
      var t = techniques[currentIntent];
      phaseIndex++;
      if (phaseIndex >= t.phases.length) {
        phaseIndex = 0;
        cycles++;
        cyclesEl.textContent = 'Cycles: ' + cycles;
      }
      startPhase();
    }

    function startPhase() {
      if (!running) return;
      var phase = techniques[currentIntent].phases[phaseIndex];
      currentPhaseDuration = phase.d;
      phaseElapsed = 0;
      phaseEl.textContent = phase.n;
      timerEl.textContent = phase.d;
      playChime(phase.n.indexOf('in') > -1 ? 528 : phase.n === 'Hold' ? 396 : 264, 0.5);
      clearClasses();
      orb.classList.add(phase.c);
    }

    function stop() {
      running = false;
      clearInterval(mainTimer);
      mainTimer = null;
      clearClasses();
      orb.classList.add('stopped');
      phaseEl.textContent = 'Ready';
      timerEl.textContent = '';
      toggleBtn.textContent = 'Start';
      ringFg.style.strokeDashoffset = circumference;
    }

    function reset() {
      stop();
      cycles = 0;
      phaseIndex = 0;
      cycleElapsed = 0;
      phaseElapsed = 0;
      cyclesEl.textContent = 'Cycles: 0';
    }

    toggleBtn.addEventListener('click', function() {
      if (running) {
        stop();
      } else {
        running = true;
        cycles = 0;
        cycleElapsed = 0;
        phaseIndex = 0;
        cyclesEl.textContent = 'Cycles: 0';
        toggleBtn.textContent = 'Stop';
        startPhase();
        mainTimer = setInterval(tick, 1000);
      }
    });
  </script>

<script>
  // Navigation
  const navWrap=document.getElementById("navWrap");
  if(navWrap){window.addEventListener("scroll",()=>{navWrap.classList.toggle("scrolled",window.scrollY>30)},{passive:true});}
  const burger=document.getElementById("burgerBtn");
  const drawer=document.getElementById("navDrawer");
  if(burger&&drawer){burger.addEventListener("click",()=>{burger.classList.toggle("open");drawer.classList.toggle("open");document.body.style.overflow=drawer.classList.contains("open")?"hidden":""});
  drawer.querySelectorAll(".nav-drawer__link").forEach(l=>{l.addEventListener("click",()=>{burger.classList.remove("open");drawer.classList.remove("open");document.body.style.overflow=""})});}
</script>
</body>
</html>
